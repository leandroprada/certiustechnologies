/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory;}else{factory(jQuery);}}(function($){var toFix=['wheel','mousewheel','DOMMouseScroll','MozMousePixelScroll'],toBind=('onwheel'in document||document.documentMode>=9)?['wheel']:['mousewheel','DomMouseScroll','MozMousePixelScroll'],slice=Array.prototype.slice,nullLowestDeltaTimeout,lowestDelta;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks;}}
var special=$.event.special.mousewheel={version:'3.1.12',setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,false);}}else{this.onmousewheel=handler;}
$.data(this,'mousewheel-line-height',special.getLineHeight(this));$.data(this,'mousewheel-page-height',special.getPageHeight(this));},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,false);}}else{this.onmousewheel=null;}
$.removeData(this,'mousewheel-line-height');$.removeData(this,'mousewheel-page-height');},getLineHeight:function(elem){var $elem=$(elem),$parent=$elem['offsetParent'in $.fn?'offsetParent':'parent']();if(!$parent.length){$parent=$('body');}
return parseInt($parent.css('fontSize'),10)||parseInt($elem.css('fontSize'),10)||16;},getPageHeight:function(elem){return $(elem).height();},settings:{adjustOldDeltas:true,normalizeOffset:true}};$.fn.extend({mousewheel:function(fn){return fn?this.bind('mousewheel',fn):this.trigger('mousewheel');},unmousewheel:function(fn){return this.unbind('mousewheel',fn);}});function handler(event){var orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,offsetX=0,offsetY=0;event=$.event.fix(orgEvent);event.type='mousewheel';if('detail'in orgEvent){deltaY=orgEvent.detail*-1;}
if('wheelDelta'in orgEvent){deltaY=orgEvent.wheelDelta;}
if('wheelDeltaY'in orgEvent){deltaY=orgEvent.wheelDeltaY;}
if('wheelDeltaX'in orgEvent){deltaX=orgEvent.wheelDeltaX*-1;}
if('axis'in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaX=deltaY*-1;deltaY=0;}
delta=deltaY===0?deltaX:deltaY;if('deltaY'in orgEvent){deltaY=orgEvent.deltaY*-1;delta=deltaY;}
if('deltaX'in orgEvent){deltaX=orgEvent.deltaX;if(deltaY===0){delta=deltaX*-1;}}
if(deltaY===0&&deltaX===0){return;}
if(orgEvent.deltaMode===1){var lineHeight=$.data(this,'mousewheel-line-height');delta*=lineHeight;deltaY*=lineHeight;deltaX*=lineHeight;}else if(orgEvent.deltaMode===2){var pageHeight=$.data(this,'mousewheel-page-height');delta*=pageHeight;deltaY*=pageHeight;deltaX*=pageHeight;}
absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta;if(shouldAdjustOldDeltas(orgEvent,absDelta)){lowestDelta/=40;}}
if(shouldAdjustOldDeltas(orgEvent,absDelta)){delta/=40;deltaX/=40;deltaY/=40;}
delta=Math[delta>=1?'floor':'ceil'](delta/lowestDelta);deltaX=Math[deltaX>=1?'floor':'ceil'](deltaX/lowestDelta);deltaY=Math[deltaY>=1?'floor':'ceil'](deltaY/lowestDelta);if(special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left;offsetY=event.clientY-boundingRect.top;}
event.deltaX=deltaX;event.deltaY=deltaY;event.deltaFactor=lowestDelta;event.offsetX=offsetX;event.offsetY=offsetY;event.deltaMode=0;args.unshift(event,delta,deltaX,deltaY);if(nullLowestDeltaTimeout){clearTimeout(nullLowestDeltaTimeout);}
nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200);return($.event.dispatch||$.event.handle).apply(this,args);}
function nullLowestDelta(){lowestDelta=null;}
function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&orgEvent.type==='mousewheel'&&absDelta%120===0;}}));;(function(a){typeof define=="function"&&define.amd?define(["jquery"],a):typeof exports=="object"?a(require("jquery")):a(window.jQuery||window.Zepto)})(function(a){var b="Close",c="BeforeClose",d="AfterClose",e="BeforeAppend",f="MarkupParse",g="Open",h="Change",i="mfp",j="."+i,k="mfp-ready",l="mfp-removing",m="mfp-prevent-close",n,o=function(){},p=!!window.jQuery,q,r=a(window),s,t,u,v,w=function(a,b){n.ev.on(i+a+j,b)},x=function(b,c,d,e){var f=document.createElement("div");return f.className="mfp-"+b,d&&(f.innerHTML=d),e?c&&c.appendChild(f):(f=a(f),c&&f.appendTo(c)),f},y=function(b,c){n.ev.triggerHandler(i+b,c),n.st.callbacks&&(b=b.charAt(0).toLowerCase()+b.slice(1),n.st.callbacks[b]&&n.st.callbacks[b].apply(n,a.isArray(c)?c:[c]))},z=function(b){if(b!==v||!n.currTemplate.closeBtn)n.currTemplate.closeBtn=a(n.st.closeMarkup.replace("%title%",n.st.tClose)),v=b;return n.currTemplate.closeBtn},A=function(){a.magnificPopup.instance||(n=new o,n.init(),a.magnificPopup.instance=n)},B=function(){var a=document.createElement("p").style,b=["ms","O","Moz","Webkit"];if(a.transition!==undefined)return!0;while(b.length)if(b.pop()+"Transition"in a)return!0;return!1};o.prototype={constructor:o,init:function(){var b=navigator.appVersion;n.isLowIE=n.isIE8=document.all&&!document.addEventListener,n.isAndroid=/android/gi.test(b),n.isIOS=/iphone|ipad|ipod/gi.test(b),n.supportsTransition=B(),n.probablyMobile=n.isAndroid||n.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),s=a(document),n.popupsCache={}},open:function(b){var c;if(b.isObj===!1){n.items=b.items.toArray(),n.index=0;var d=b.items,e;for(c=0;c<d.length;c++){e=d[c],e.parsed&&(e=e.el[0]);if(e===b.el[0]){n.index=c;break}}}else n.items=a.isArray(b.items)?b.items:[b.items],n.index=b.index||0;if(n.isOpen){n.updateItemHTML();return}n.types=[],u="",b.mainEl&&b.mainEl.length?n.ev=b.mainEl.eq(0):n.ev=s,b.key?(n.popupsCache[b.key]||(n.popupsCache[b.key]={}),n.currTemplate=n.popupsCache[b.key]):n.currTemplate={},n.st=a.extend(!0,{},a.magnificPopup.defaults,b),n.fixedContentPos=n.st.fixedContentPos==="auto"?!n.probablyMobile:n.st.fixedContentPos,n.st.modal&&(n.st.closeOnContentClick=!1,n.st.closeOnBgClick=!1,n.st.showCloseBtn=!1,n.st.enableEscapeKey=!1),n.bgOverlay||(n.bgOverlay=x("bg").on("click"+j,function(){n.close()}),n.wrap=x("wrap").attr("tabindex",-1).on("click"+j,function(a){n._checkIfClose(a.target)&&n.close()}),n.container=x("container",n.wrap)),n.contentContainer=x("content"),n.st.preloader&&(n.preloader=x("preloader",n.container,n.st.tLoading));var h=a.magnificPopup.modules;for(c=0;c<h.length;c++){var i=h[c];i=i.charAt(0).toUpperCase()+i.slice(1),n["init"+i].call(n)}y("BeforeOpen"),n.st.showCloseBtn&&(n.st.closeBtnInside?(w(f,function(a,b,c,d){c.close_replaceWith=z(d.type)}),u+=" mfp-close-btn-in"):n.wrap.append(z())),n.st.alignTop&&(u+=" mfp-align-top"),n.fixedContentPos?n.wrap.css({overflow:n.st.overflowY,overflowX:"hidden",overflowY:n.st.overflowY}):n.wrap.css({top:r.scrollTop(),position:"absolute"}),(n.st.fixedBgPos===!1||n.st.fixedBgPos==="auto"&&!n.fixedContentPos)&&n.bgOverlay.css({height:s.height(),position:"absolute"}),n.st.enableEscapeKey&&s.on("keyup"+j,function(a){a.keyCode===27&&n.close()}),r.on("resize"+j,function(){n.updateSize()}),n.st.closeOnContentClick||(u+=" mfp-auto-cursor"),u&&n.wrap.addClass(u);var l=n.wH=r.height(),m={};if(n.fixedContentPos&&n._hasScrollBar(l)){var o=n._getScrollbarSize();o&&(m.marginRight=o)}n.fixedContentPos&&(n.isIE7?a("body, html").css("overflow","hidden"):m.overflow="hidden");var p=n.st.mainClass;return n.isIE7&&(p+=" mfp-ie7"),p&&n._addClassToMFP(p),n.updateItemHTML(),y("BuildControls"),a("html").css(m),n.bgOverlay.add(n.wrap).prependTo(n.st.prependTo||a(document.body)),n._lastFocusedEl=document.activeElement,setTimeout(function(){n.content?(n._addClassToMFP(k),n._setFocus()):n.bgOverlay.addClass(k),s.on("focusin"+j,n._onFocusIn)},16),n.isOpen=!0,n.updateSize(l),y(g),b},close:function(){if(!n.isOpen)return;y(c),n.isOpen=!1,n.st.removalDelay&&!n.isLowIE&&n.supportsTransition?(n._addClassToMFP(l),setTimeout(function(){n._close()},n.st.removalDelay)):n._close()},_close:function(){y(b);var c=l+" "+k+" ";n.bgOverlay.detach(),n.wrap.detach(),n.container.empty(),n.st.mainClass&&(c+=n.st.mainClass+" "),n._removeClassFromMFP(c);if(n.fixedContentPos){var e={marginRight:""};n.isIE7?a("body, html").css("overflow",""):e.overflow="",a("html").css(e)}s.off("keyup"+j+" focusin"+j),n.ev.off(j),n.wrap.attr("class","mfp-wrap").removeAttr("style"),n.bgOverlay.attr("class","mfp-bg"),n.container.attr("class","mfp-container"),n.st.showCloseBtn&&(!n.st.closeBtnInside||n.currTemplate[n.currItem.type]===!0)&&n.currTemplate.closeBtn&&n.currTemplate.closeBtn.detach(),n.st.autoFocusLast&&n._lastFocusedEl&&a(n._lastFocusedEl).focus(),n.currItem=null,n.content=null,n.currTemplate=null,n.prevHeight=0,y(d)},updateSize:function(a){if(n.isIOS){var b=document.documentElement.clientWidth/window.innerWidth,c=window.innerHeight*b;n.wrap.css("height",c),n.wH=c}else n.wH=a||r.height();n.fixedContentPos||n.wrap.css("height",n.wH),y("Resize")},updateItemHTML:function(){var b=n.items[n.index];n.contentContainer.detach(),n.content&&n.content.detach(),b.parsed||(b=n.parseEl(n.index));var c=b.type;y("BeforeChange",[n.currItem?n.currItem.type:"",c]),n.currItem=b;if(!n.currTemplate[c]){var d=n.st[c]?n.st[c].markup:!1;y("FirstMarkupParse",d),d?n.currTemplate[c]=a(d):n.currTemplate[c]=!0}t&&t!==b.type&&n.container.removeClass("mfp-"+t+"-holder");var e=n["get"+c.charAt(0).toUpperCase()+c.slice(1)](b,n.currTemplate[c]);n.appendContent(e,c),b.preloaded=!0,y(h,b),t=b.type,n.container.prepend(n.contentContainer),y("AfterChange")},appendContent:function(a,b){n.content=a,a?n.st.showCloseBtn&&n.st.closeBtnInside&&n.currTemplate[b]===!0?n.content.find(".mfp-close").length||n.content.append(z()):n.content=a:n.content="",y(e),n.container.addClass("mfp-"+b+"-holder"),n.contentContainer.append(n.content)},parseEl:function(b){var c=n.items[b],d;c.tagName?c={el:a(c)}:(d=c.type,c={data:c,src:c.src});if(c.el){var e=n.types;for(var f=0;f<e.length;f++)if(c.el.hasClass("mfp-"+e[f])){d=e[f];break}c.src=c.el.attr("data-mfp-src"),c.src||(c.src=c.el.attr("href"))}return c.type=d||n.st.type||"inline",c.index=b,c.parsed=!0,n.items[b]=c,y("ElementParse",c),n.items[b]},addGroup:function(a,b){var c=function(c){c.mfpEl=this,n._openClick(c,a,b)};b||(b={});var d="click.magnificPopup";b.mainEl=a,b.items?(b.isObj=!0,a.off(d).on(d,c)):(b.isObj=!1,b.delegate?a.off(d).on(d,b.delegate,c):(b.items=a,a.off(d).on(d,c)))},_openClick:function(b,c,d){var e=d.midClick!==undefined?d.midClick:a.magnificPopup.defaults.midClick;if(!e&&(b.which===2||b.ctrlKey||b.metaKey||b.altKey||b.shiftKey))return;var f=d.disableOn!==undefined?d.disableOn:a.magnificPopup.defaults.disableOn;if(f)if(a.isFunction(f)){if(!f.call(n))return!0}else if(r.width()<f)return!0;b.type&&(b.preventDefault(),n.isOpen&&b.stopPropagation()),d.el=a(b.mfpEl),d.delegate&&(d.items=c.find(d.delegate)),n.open(d)},updateStatus:function(a,b){if(n.preloader){q!==a&&n.container.removeClass("mfp-s-"+q),!b&&a==="loading"&&(b=n.st.tLoading);var c={status:a,text:b};y("UpdateStatus",c),a=c.status,b=c.text,n.preloader.html(b),n.preloader.find("a").on("click",function(a){a.stopImmediatePropagation()}),n.container.addClass("mfp-s-"+a),q=a}},_checkIfClose:function(b){if(a(b).hasClass(m))return;var c=n.st.closeOnContentClick,d=n.st.closeOnBgClick;if(c&&d)return!0;if(!n.content||a(b).hasClass("mfp-close")||n.preloader&&b===n.preloader[0])return!0;if(b!==n.content[0]&&!a.contains(n.content[0],b)){if(d&&a.contains(document,b))return!0}else if(c)return!0;return!1},_addClassToMFP:function(a){n.bgOverlay.addClass(a),n.wrap.addClass(a)},_removeClassFromMFP:function(a){this.bgOverlay.removeClass(a),n.wrap.removeClass(a)},_hasScrollBar:function(a){return(n.isIE7?s.height():document.body.scrollHeight)>(a||r.height())},_setFocus:function(){(n.st.focus?n.content.find(n.st.focus).eq(0):n.wrap).focus()},_onFocusIn:function(b){if(b.target!==n.wrap[0]&&!a.contains(n.wrap[0],b.target))return n._setFocus(),!1},_parseMarkup:function(b,c,d){var e;d.data&&(c=a.extend(d.data,c)),y(f,[b,c,d]),a.each(c,function(c,d){if(d===undefined||d===!1)return!0;e=c.split("_");if(e.length>1){var f=b.find(j+"-"+e[0]);if(f.length>0){var g=e[1];g==="replaceWith"?f[0]!==d[0]&&f.replaceWith(d):g==="img"?f.is("img")?f.attr("src",d):f.replaceWith(a("<img>").attr("src",d).attr("class",f.attr("class"))):f.attr(e[1],d)}}else b.find(j+"-"+c).html(d)})},_getScrollbarSize:function(){if(n.scrollbarSize===undefined){var a=document.createElement("div");a.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(a),n.scrollbarSize=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return n.scrollbarSize}},a.magnificPopup={instance:null,proto:o.prototype,modules:[],open:function(b,c){return A(),b?b=a.extend(!0,{},b):b={},b.isObj=!0,b.index=c||0,this.instance.open(b)},close:function(){return a.magnificPopup.instance&&a.magnificPopup.instance.close()},registerModule:function(b,c){c.options&&(a.magnificPopup.defaults[b]=c.options),a.extend(this.proto,c.proto),this.modules.push(b)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&#215;</button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:!0}},a.fn.magnificPopup=function(b){A();var c=a(this);if(typeof b=="string")if(b==="open"){var d,e=p?c.data("magnificPopup"):c[0].magnificPopup,f=parseInt(arguments[1],10)||0;e.items?d=e.items[f]:(d=c,e.delegate&&(d=d.find(e.delegate)),d=d.eq(f)),n._openClick({mfpEl:d},c,e)}else n.isOpen&&n[b].apply(n,Array.prototype.slice.call(arguments,1));else b=a.extend(!0,{},b),p?c.data("magnificPopup",b):c[0].magnificPopup=b,n.addGroup(c,b);return c};var C="inline",D,E,F,G=function(){F&&(E.after(F.addClass(D)).detach(),F=null)};a.magnificPopup.registerModule(C,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){n.types.push(C),w(b+"."+C,function(){G()})},getInline:function(b,c){G();if(b.src){var d=n.st.inline,e=a(b.src);if(e.length){var f=e[0].parentNode;f&&f.tagName&&(E||(D=d.hiddenClass,E=x(D),D="mfp-"+D),F=e.after(E).detach().removeClass(D)),n.updateStatus("ready")}else n.updateStatus("error",d.tNotFound),e=a("<div>");return b.inlineElement=e,e}return n.updateStatus("ready"),n._parseMarkup(c,{},b),c}}});var H="ajax",I,J=function(){I&&a(document.body).removeClass(I)},K=function(){J(),n.req&&n.req.abort()};a.magnificPopup.registerModule(H,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){n.types.push(H),I=n.st.ajax.cursor,w(b+"."+H,K),w("BeforeChange."+H,K)},getAjax:function(b){I&&a(document.body).addClass(I),n.updateStatus("loading");var c=a.extend({url:b.src,success:function(c,d,e){var f={data:c,xhr:e};y("ParseAjax",f),n.appendContent(a(f.data),H),b.finished=!0,J(),n._setFocus(),setTimeout(function(){n.wrap.addClass(k)},16),n.updateStatus("ready"),y("AjaxContentAdded")},error:function(){J(),b.finished=b.loadError=!0,n.updateStatus("error",n.st.ajax.tError.replace("%url%",b.src))}},n.st.ajax.settings);return n.req=a.ajax(c),""}}});var L,M=function(b){if(b.data&&b.data.title!==undefined)return b.data.title;var c=n.st.image.titleSrc;if(c){if(a.isFunction(c))return c.call(n,b);if(b.el)return b.el.attr(c)||""}return""};a.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var c=n.st.image,d=".image";n.types.push("image"),w(g+d,function(){n.currItem.type==="image"&&c.cursor&&a(document.body).addClass(c.cursor)}),w(b+d,function(){c.cursor&&a(document.body).removeClass(c.cursor),r.off("resize"+j)}),w("Resize"+d,n.resizeImage),n.isLowIE&&w("AfterChange",n.resizeImage)},resizeImage:function(){var a=n.currItem;if(!a||!a.img)return;if(n.st.image.verticalFit){var b=0;n.isLowIE&&(b=parseInt(a.img.css("padding-top"),10)+parseInt(a.img.css("padding-bottom"),10)),a.img.css("max-height",n.wH-b)}},_onImageHasSize:function(a){a.img&&(a.hasSize=!0,L&&clearInterval(L),a.isCheckingImgSize=!1,y("ImageHasSize",a),a.imgHidden&&(n.content&&n.content.removeClass("mfp-loading"),a.imgHidden=!1))},findImageSize:function(a){var b=0,c=a.img[0],d=function(e){L&&clearInterval(L),L=setInterval(function(){if(c.naturalWidth>0){n._onImageHasSize(a);return}b>200&&clearInterval(L),b++,b===3?d(10):b===40?d(50):b===100&&d(500)},e)};d(1)},getImage:function(b,c){var d=0,e=function(){b&&(b.img[0].complete?(b.img.off(".mfploader"),b===n.currItem&&(n._onImageHasSize(b),n.updateStatus("ready")),b.hasSize=!0,b.loaded=!0,y("ImageLoadComplete")):(d++,d<200?setTimeout(e,100):f()))},f=function(){b&&(b.img.off(".mfploader"),b===n.currItem&&(n._onImageHasSize(b),n.updateStatus("error",g.tError.replace("%url%",b.src))),b.hasSize=!0,b.loaded=!0,b.loadError=!0)},g=n.st.image,h=c.find(".mfp-img");if(h.length){var i=document.createElement("img");i.className="mfp-img",b.el&&b.el.find("img").length&&(i.alt=b.el.find("img").attr("alt")),b.img=a(i).on("load.mfploader",e).on("error.mfploader",f),i.src=b.src,h.is("img")&&(b.img=b.img.clone()),i=b.img[0],i.naturalWidth>0?b.hasSize=!0:i.width||(b.hasSize=!1)}return n._parseMarkup(c,{title:M(b),img_replaceWith:b.img},b),n.resizeImage(),b.hasSize?(L&&clearInterval(L),b.loadError?(c.addClass("mfp-loading"),n.updateStatus("error",g.tError.replace("%url%",b.src))):(c.removeClass("mfp-loading"),n.updateStatus("ready")),c):(n.updateStatus("loading"),b.loading=!0,b.hasSize||(b.imgHidden=!0,c.addClass("mfp-loading"),n.findImageSize(b)),c)}}});var N,O=function(){return N===undefined&&(N=document.createElement("p").style.MozTransform!==undefined),N};a.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(a){return a.is("img")?a:a.find("img")}},proto:{initZoom:function(){var a=n.st.zoom,d=".zoom",e;if(!a.enabled||!n.supportsTransition)return;var f=a.duration,g=function(b){var c=b.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),d="all "+a.duration/1e3+"s "+a.easing,e={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},f="transition";return e["-webkit-"+f]=e["-moz-"+f]=e["-o-"+f]=e[f]=d,c.css(e),c},h=function(){n.content.css("visibility","visible")},i,j;w("BuildControls"+d,function(){if(n._allowZoom()){clearTimeout(i),n.content.css("visibility","hidden"),e=n._getItemToZoom();if(!e){h();return}j=g(e),j.css(n._getOffset()),n.wrap.append(j),i=setTimeout(function(){j.css(n._getOffset(!0)),i=setTimeout(function(){h(),setTimeout(function(){j.remove(),e=j=null,y("ZoomAnimationEnded")},16)},f)},16)}}),w(c+d,function(){if(n._allowZoom()){clearTimeout(i),n.st.removalDelay=f;if(!e){e=n._getItemToZoom();if(!e)return;j=g(e)}j.css(n._getOffset(!0)),n.wrap.append(j),n.content.css("visibility","hidden"),setTimeout(function(){j.css(n._getOffset())},16)}}),w(b+d,function(){n._allowZoom()&&(h(),j&&j.remove(),e=null)})},_allowZoom:function(){return n.currItem.type==="image"},_getItemToZoom:function(){return n.currItem.hasSize?n.currItem.img:!1},_getOffset:function(b){var c;b?c=n.currItem.img:c=n.st.zoom.opener(n.currItem.el||n.currItem);var d=c.offset(),e=parseInt(c.css("padding-top"),10),f=parseInt(c.css("padding-bottom"),10);d.top-=a(window).scrollTop()-e;var g={width:c.width(),height:(p?c.innerHeight():c[0].offsetHeight)-f-e};return O()?g["-moz-transform"]=g.transform="translate("+d.left+"px,"+d.top+"px)":(g.left=d.left,g.top=d.top),g}}});var P="iframe",Q="//about:blank",R=function(a){if(n.currTemplate[P]){var b=n.currTemplate[P].find("iframe");b.length&&(a||(b[0].src=Q),n.isIE8&&b.css("display",a?"block":"none"))}};a.magnificPopup.registerModule(P,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){n.types.push(P),w("BeforeChange",function(a,b,c){b!==c&&(b===P?R():c===P&&R(!0))}),w(b+"."+P,function(){R()})},getIframe:function(b,c){var d=b.src,e=n.st.iframe;a.each(e.patterns,function(){if(d.indexOf(this.index)>-1)return this.id&&(typeof this.id=="string"?d=d.substr(d.lastIndexOf(this.id)+this.id.length,d.length):d=this.id.call(this,d)),d=this.src.replace("%id%",d),!1});var f={};return e.srcAction&&(f[e.srcAction]=d),n._parseMarkup(c,f,b),n.updateStatus("ready"),c}}});var S=function(a){var b=n.items.length;return a>b-1?a-b:a<0?b+a:a},T=function(a,b,c){return a.replace(/%curr%/gi,b+1).replace(/%total%/gi,c)};a.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var c=n.st.gallery,d=".mfp-gallery";n.direction=!0;if(!c||!c.enabled)return!1;u+=" mfp-gallery",w(g+d,function(){c.navigateByImgClick&&n.wrap.on("click"+d,".mfp-img",function(){if(n.items.length>1)return n.next(),!1}),s.on("keydown"+d,function(a){a.keyCode===37?n.prev():a.keyCode===39&&n.next()})}),w("UpdateStatus"+d,function(a,b){b.text&&(b.text=T(b.text,n.currItem.index,n.items.length))}),w(f+d,function(a,b,d,e){var f=n.items.length;d.counter=f>1?T(c.tCounter,e.index,f):""}),w("BuildControls"+d,function(){if(n.items.length>1&&c.arrows&&!n.arrowLeft){var b=c.arrowMarkup,d=n.arrowLeft=a(b.replace(/%title%/gi,c.tPrev).replace(/%dir%/gi,"left")).addClass(m),e=n.arrowRight=a(b.replace(/%title%/gi,c.tNext).replace(/%dir%/gi,"right")).addClass(m);d.click(function(){n.prev()}),e.click(function(){n.next()}),n.container.append(d.add(e))}}),w(h+d,function(){n._preloadTimeout&&clearTimeout(n._preloadTimeout),n._preloadTimeout=setTimeout(function(){n.preloadNearbyImages(),n._preloadTimeout=null},16)}),w(b+d,function(){s.off(d),n.wrap.off("click"+d),n.arrowRight=n.arrowLeft=null})},next:function(){n.direction=!0,n.index=S(n.index+1),n.updateItemHTML()},prev:function(){n.direction=!1,n.index=S(n.index-1),n.updateItemHTML()},goTo:function(a){n.direction=a>=n.index,n.index=a,n.updateItemHTML()},preloadNearbyImages:function(){var a=n.st.gallery.preload,b=Math.min(a[0],n.items.length),c=Math.min(a[1],n.items.length),d;for(d=1;d<=(n.direction?c:b);d++)n._preloadItem(n.index+d);for(d=1;d<=(n.direction?b:c);d++)n._preloadItem(n.index-d)},_preloadItem:function(b){b=S(b);if(n.items[b].preloaded)return;var c=n.items[b];c.parsed||(c=n.parseEl(b)),y("LazyLoad",c),c.type==="image"&&(c.img=a('<img class="mfp-img" />').on("load.mfploader",function(){c.hasSize=!0}).on("error.mfploader",function(){c.hasSize=!0,c.loadError=!0,y("LazyLoadError",c)}).attr("src",c.src)),c.preloaded=!0}}});var U="retina";a.magnificPopup.registerModule(U,{options:{replaceSrc:function(a){return a.src.replace(/\.\w+$/,function(a){return"@2x"+a})},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var a=n.st.retina,b=a.ratio;b=isNaN(b)?b():b,b>1&&(w("ImageHasSize."+U,function(a,c){c.img.css({"max-width":c.img[0].naturalWidth/b,width:"100%"})}),w("ElementParse."+U,function(c,d){d.src=a.replaceSrc(d,b)}))}}}}),A()});;(function($){"use strict";var Mapplic=function(element){var self=this;self.o={selector:'[id^=landmark] > *',landmark:false,mapfill:false,height:420,markers:true,minimap:true,sidebar:true,search:true,deeplinking:true,clearbutton:true,zoombuttons:true,zoomoutclose:false,action:'tooltip',lightbox:true,hovertip:true,smartip:true,fillcolor:'',fullscreen:true,mousewheel:true,alphabetic:false,maxscale:4,zoom:true};self.el=element;self.init=function(options){self.o=$.extend(self.o,options);self.el.addClass('mapplic-element mapplic-loading');if(self.el.data('height'))self.o.height=self.el.data('height');self.el.height(self.o.height);var data=self.el.data('mapdata');if(data){self.el.removeAttr('data-mapdata');processData(data);self.el.removeClass('mapplic-loading');}
return self;}
function Tooltip(){this.el=null;this.pin=null;this.shift=6;this.drop=0;this.location=null;this.tooltipthumb=true;this.tooltiplink=true;this.init=function(){var s=this;this.el=$('<div></div>').addClass('mapplic-tooltip');this.close=$('<a></a>').addClass('mapplic-tooltip-close').attr('href','#').appendTo(this.el);this.close.on('click touchend',function(e){e.preventDefault();self.hideLocation();if(!self.o.zoom||self.o.zoomoutclose)self.moveTo(0.5,0.5,self.fitscale,400,'easeInOutCubic');});if(this.tooltipthumb)this.thumbnail=$('<img>').addClass('mapplic-tooltip-thumbnail').hide().appendTo(this.el);this.content=$('<div></div>').addClass('mapplic-tooltip-content').appendTo(this.el);this.title=$('<h4></h4>').addClass('mapplic-tooltip-title').appendTo(this.content);this.desc=$('<div></div>').addClass('mapplic-tooltip-description').appendTo(this.content);if(this.tooltiplink)this.link=$('<a>'+mapplic_localization.more+'</a>').addClass('mapplic-popup-link').attr('href','#').hide().appendTo(this.el);this.triangle=$('<div></div>').addClass('mapplic-tooltip-triangle').prependTo(this.el);self.map.append(this.el);return this;}
this.show=function(location){if(location){var s=this;this.location=location;if(self.hovertip)self.hovertip.hide();if(this.tooltipthumb){if(location.thumbnail)this.thumbnail.attr('src',location.thumbnail).show();else this.thumbnail.hide();}
if(this.tooltiplink){if(location.link)this.link.attr('href',location.link).show();else this.link.hide();}
this.title.text(location.title);if(location.description)this.desc.html(location.description);else this.desc.empty();this.content[0].scrollTop=0;this.pin=$('.mapplic-pin[data-location="'+location.id+'"]');if(this.pin.length==0){this.shift=20;}
else this.shift=Math.abs(parseFloat(this.pin.css('margin-top')))+20;$('img',this.el).off('load').on('load',function(){s.position();s.zoom(location);});this.position();this.el.stop().show();this.zoom(location);}}
this.position=function(){if(this.location){var cx=self.map.offset().left+self.map.width()*this.location.x-self.container.offset().left,cy=self.map.offset().top+self.map.height()*this.location.y-self.container.offset().top;var x=this.location.x*100,y=this.location.y*100,mt=-this.el.outerHeight()-this.shift,ml=-this.el.outerWidth()/2;if(self.o.smartip){var verticalPos=0.5;if(Math.abs(mt)>cy){mt=8+2;if(this.pin&&this.pin.length)mt=this.pin.height()+parseFloat(this.pin.css('margin-top'))+20;this.el.addClass('mapplic-bottom');}
else this.el.removeClass('mapplic-bottom');if(this.el.outerWidth()/2>cx)
verticalPos=0.5-(this.el.outerWidth()/2-cx)/this.el.outerWidth();else if((self.container.width()-cx-this.el.outerWidth()/2)<0)
verticalPos=0.5+(cx+this.el.outerWidth()/2-self.container.width())/this.el.outerWidth();verticalPos=Math.max(0,Math.min(1,verticalPos));ml=-this.el.outerWidth()*verticalPos;this.triangle.css('left',Math.max(5,Math.min(95,verticalPos*100))+'%');}
this.el.css({left:x+'%',top:y+'%',marginTop:mt,marginLeft:ml});this.drop=this.el.outerHeight()+this.shift;}}
this.zoom=function(location){var ry=0.5,zoom=location.zoom?parseFloat(location.zoom):self.o.maxscale;ry=((self.container.height()-this.drop)/2+this.drop)/self.container.height();self.moveTo(location.x,location.y,zoom,600,'easeInOutCubic',ry);}
this.hide=function(){var s=this;this.location=null;this.el.stop().fadeOut(300,function(){if(s.desc)s.desc.empty();});}}
function Lightbox(){this.el=null;this.init=function(){this.el=$('<div></div>').addClass('mapplic-lightbox mfp-hide');this.title=$('<h2></h2>').addClass('mapplic-lightbox-title').appendTo(this.el);this.desc=$('<div></div>').addClass('mapplic-lightbox-description').appendTo(this.el);this.link=$('<a>'+mapplic_localization.more+'</a>').addClass('mapplic-popup-link').attr('href','#').hide().appendTo(this.el);$('body').magnificPopup({delegate:'.mapplic-popup-image',type:'image',removalDelay:300,mainClass:'mfp-fade'});self.el.append(this.el);return this;}
this.show=function(location){this.location=location;this.title.text(location.title);this.desc.html(location.description);if(location.link)this.link.attr('href',location.link).show();else this.link.hide();var s=this;$.magnificPopup.open({items:{src:this.el},type:'inline',removalDelay:300,mainClass:'mfp-fade',callbacks:{beforeClose:function(){s.hide();}}});var zoom=location.zoom?parseFloat(location.zoom):self.o.maxscale;self.moveTo(location.x,location.y,zoom,600,'easeInOutCubic');if(self.tooltip)self.tooltip.hide();}
this.hide=function(){this.location=null;self.hideLocation();if(!self.o.zoom||self.o.zoomoutclose)self.moveTo(0.5,0.5,self.fitscale,400,'easeInOutCubic');}}
function HoverTooltip(){this.el=null;this.pin=null;this.shift=6;this.hovertipdesc=false;this.init=function(){var s=this;this.el=$('<div></div>').addClass('mapplic-tooltip mapplic-hovertip');this.title=$('<h4></h4>').addClass('mapplic-tooltip-title').appendTo(this.el);if(this.hovertipdesc)this.desc=$('<div></div>').addClass('mapplic-tooltip-description').appendTo(this.el);this.triangle=$('<div></div>').addClass('mapplic-tooltip-triangle').appendTo(this.el);$(self.map).on('mouseover','.mapplic-layer a',function(){var id='';if($(this).hasClass('mapplic-pin')){id=$(this).data('location');s.pin=$('.mapplic-pin[data-location="'+id+'"]');s.shift=Math.abs(parseFloat(s.pin.css('margin-top')))+20;}
else{id=$(this).attr('xlink:href').slice(1);s.shift=20;}
var location=self.getLocationData(id);if(location)s.show(location);}).on('mouseout',function(){s.hide();});if(self.o.selector){$(self.map).on('mouseover',self.o.selector,function(){var location=self.getLocationData($(this).attr('id'));s.shift=20;if(location)s.show(location);}).on('mouseout',function(){s.hide();});}
self.map.append(this.el);return this;}
this.show=function(location){if(self.tooltip.location!=location){this.title.text(location.title);if(this.hovertipdesc)this.desc.html(location.description);this.position(location);this.el.stop().fadeIn(100);}}
this.position=function(location){var cx=self.map.offset().left+self.map.width()*location.x-self.container.offset().left,cy=self.map.offset().top+self.map.height()*location.y-self.container.offset().top;var x=location.x*100,y=location.y*100,mt=-this.el.outerHeight()-this.shift,ml=0;var verticalPos=0.5;if(Math.abs(mt)>cy){mt=8+2;if(this.pin&&this.pin.length)mt=this.pin.height()+parseFloat(this.pin.css('margin-top'))+20;this.el.addClass('mapplic-bottom');}
else this.el.removeClass('mapplic-bottom');if(this.el.outerWidth()/2>cx)
verticalPos=0.5-(this.el.outerWidth()/2-cx)/this.el.outerWidth();else if((self.container.width()-cx-this.el.outerWidth()/2)<0)
verticalPos=0.5+(cx+this.el.outerWidth()/2-self.container.width())/this.el.outerWidth();ml=-this.el.outerWidth()*verticalPos;this.triangle.css('left',Math.max(10,Math.min(90,verticalPos*100))+'%');this.el.css({left:x+'%',top:y+'%',marginTop:mt,marginLeft:ml});}
this.hide=function(){this.el.stop().fadeOut(200);}}
function Deeplinking(){this.param='location';this.init=function(){var s=this;this.check(0);window.onpopstate=function(e){if(e.state){s.check(600);}
return false;}}
this.check=function(easing){var id=this.getUrlParam(this.param);self.showLocation(id,easing,true);}
this.getUrlParam=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return results===null?"":decodeURIComponent(results[1].replace(/\+/g," "));}
this.update=function(id){var url=window.location.protocol+"//"+window.location.host+window.location.pathname+'?'+this.param+'='+id;window.history.pushState({path:url},'',url);}
this.clear=function(){history.pushState('',document.title,window.location.pathname);}}
function DeeplinkingHash(){this.param='location';this.init=function(){var s=this;this.check(0);$(window).on('hashchange',function(){s.check(600);});}
this.check=function(easing){var id=location.hash.slice(this.param.length+2);self.showLocation(id,easing,true);}
this.update=function(id){window.location.hash=this.param+'-'+id;}
this.clear=function(){window.location.hash=this.param;}}
function Minimap(){this.el=null;this.opacity=null;this.init=function(){this.el=$('<div></div>').addClass('mapplic-minimap').appendTo(self.container);this.el.click(function(e){e.preventDefault();var x=(e.pageX-$(this).offset().left)/$(this).width(),y=(e.pageY-$(this).offset().top)/$(this).height();self.moveTo(x,y,self.scale/self.fitscale,100);});}
this.addLayer=function(data){var layer=$('<div></div>').addClass('mapplic-minimap-layer').attr('data-floor',data.id).appendTo(this.el),s=this;$('<img>').attr('src',data.minimap).addClass('mapplic-minimap-background').appendTo(layer);$('<div></div>').addClass('mapplic-minimap-overlay').appendTo(layer);$('<img>').attr('src',data.minimap).addClass('mapplic-minimap-active').on('load',function(){s.update();$(this).addClass('mapplic-clip-transition');}).appendTo(layer);}
this.show=function(target){$('.mapplic-minimap-layer',this.el).hide();$('.mapplic-minimap-layer[data-floor="'+target+'"]',this.el).show();}
this.update=function(x,y){var active=$('.mapplic-minimap-active',this.el);if(x===undefined)x=self.x;if(y===undefined)y=self.y;var width=Math.round(self.container.width()/self.contentWidth/self.scale*this.el.width()),height=Math.round(self.container.height()/self.contentHeight/self.scale*this.el.height()),top=Math.round(-y/self.contentHeight/self.scale*this.el.height()),left=Math.round(-x/self.contentWidth/self.scale*this.el.width()),right=left+width,bottom=top+height;active.each(function(){$(this)[0].style.clip='rect('+top+'px, '+right+'px, '+bottom+'px, '+left+'px)';});var s=this;this.el.show();this.el.css('opacity',1.0);clearTimeout(this.opacity);this.opacity=setTimeout(function(){s.el.css('opacity',0);setTimeout(function(){s.el.hide();},600);},2000);}}
function Sidebar(){this.el=null;this.list=null;this.init=function(){var s=this;this.el=$('<div></div>').addClass('mapplic-sidebar').appendTo(self.el);if(self.o.search){var form=$('<form></form>').addClass('mapplic-search-form').submit(function(){return false;}).appendTo(this.el);self.clear=$('<button></button>').attr('type','button').addClass('mapplic-search-clear').click(function(){input.val('');input.keyup();}).appendTo(form);var input=$('<input>').attr({'type':'text','spellcheck':'false','placeholder':mapplic_localization.search}).addClass('mapplic-search-input').keyup(function(){var keyword=$(this).val();s.search(keyword);}).prependTo(form);}
var listContainer=$('<div></div>').addClass('mapplic-list-container').appendTo(this.el);this.list=$('<ol></ol>').addClass('mapplic-list').appendTo(listContainer);this.notfound=$('<p></p>').addClass('mapplic-not-found').text(mapplic_localization.not_found).appendTo(listContainer);if(!self.o.search)listContainer.css('padding-top','0');}
this.addCategories=function(categories){var list=this.list;if(categories){$.each(categories,function(index,category){var item=$('<li></li>').addClass('mapplic-list-category').attr('data-category',category.id);var ol=$('<ol></ol>').css('border-color',category.color).appendTo(item);if(category.show=='false')ol.hide();else item.addClass('mapplic-opened');var link=$('<a></a>').attr('href','#').attr('title',category.title).css('background-color',category.color).text(category.title).prependTo(item);link.on('click',function(e){e.preventDefault();item.toggleClass('mapplic-opened');ol.slideToggle(200);});if(category.icon)$('<img>').attr('src',category.icon).addClass('mapplic-list-thumbnail').prependTo(link);$('<span></span>').text('0').addClass('mapplic-list-count').prependTo(link);list.append(item);});}}
this.addLocation=function(data){var item=$('<li></li>').addClass('mapplic-list-location').addClass('mapplic-list-shown').attr('data-location',data.id);var link=$('<a></a>').attr('href','#').click(function(e){e.preventDefault();self.showLocation(data.id,600);if($(window).width()<668){$('html, body').animate({scrollTop:self.container.offset().top},400);}}).appendTo(item);if(data.thumbnail)$('<img>').attr('src',data.thumbnail).addClass('mapplic-list-thumbnail').appendTo(link);$('<h4></h4>').text(data.title).appendTo(link)
$('<span></span>').html(data.about).appendTo(link);var category=$('.mapplic-list-category[data-category="'+data.category+'"]');if(category.length)$('ol',category).append(item);else this.list.append(item);$('.mapplic-list-count',category).text($('.mapplic-list-shown',category).length);}
this.search=function(keyword){if(keyword)self.clear.fadeIn(100);else self.clear.fadeOut(100);$('.mapplic-list li',self.el).each(function(){if($(this).text().search(new RegExp(keyword,"i"))<0){$(this).removeClass('mapplic-list-shown');$(this).slideUp(200);}else{$(this).addClass('mapplic-list-shown');$(this).show();}});$('.mapplic-list > li',self.el).each(function(){var count=$('.mapplic-list-shown',this).length;$('.mapplic-list-count',this).text(count);});if($('.mapplic-list > li.mapplic-list-shown').length>0)this.notfound.fadeOut(200);else this.notfound.fadeIn(200);}}
function ClearButton(){this.el=null;this.init=function(){this.el=$('<a></a>').attr('href','#').addClass('mapplic-clear-button').appendTo(self.container);this.el.on('click touchstart',function(e){e.preventDefault();self.hideLocation();self.moveTo(0.5,0.5,self.fitscale,400,'easeInOutCubic');});return this;}}
function ZoomButtons(){this.el=null;this.init=function(){this.el=$('<div></div>').addClass('mapplic-zoom-buttons').appendTo(self.container);if(!self.o.clearbutton)this.el.css('bottom','0');this.zoomin=$('<a></ha>').attr('href','#').addClass('mapplic-zoomin-button').appendTo(this.el);this.zoomin.on('click touchstart',function(e){e.preventDefault();var scale=self.scale;self.scale=normalizeScale(scale+scale*0.8);self.x=normalizeX(self.x-(self.container.width()/2-self.x)*(self.scale/scale-1));self.y=normalizeY(self.y-(self.container.height()/2-self.y)*(self.scale/scale-1));zoomTo(self.x,self.y,self.scale,400,'easeInOutCubic');});this.zoomout=$('<a></ha>').attr('href','#').addClass('mapplic-zoomout-button').appendTo(this.el);this.zoomout.on('click touchstart',function(e){e.preventDefault();var scale=self.scale;self.scale=normalizeScale(scale-scale*0.4);self.x=normalizeX(self.x-(self.container.width()/2-self.x)*(self.scale/scale-1));self.y=normalizeY(self.y-(self.container.height()/2-self.y)*(self.scale/scale-1));zoomTo(self.x,self.y,self.scale,400,'easeInOutCubic');});return this;}
this.update=function(scale){this.zoomin.removeClass('mapplic-disabled');this.zoomout.removeClass('mapplic-disabled');if(scale==self.fitscale)this.zoomout.addClass('mapplic-disabled');else if(scale==self.o.maxscale)this.zoomin.addClass('mapplic-disabled');}}
function Fullscreen(){this.el=null;this.init=function(){$('<a></a>').attr('href','#').attr('href','#').addClass('mapplic-fullscreen-button').click(function(e){e.preventDefault();self.el.toggleClass('mapplic-fullscreen');$(document).resize();}).appendTo(self.container);$(document).keyup(function(e){if(e.keyCode===27){$('.mapplic-element.mapplic-fullscreen').removeClass('mapplic-fullscreen');$(document).resize();}});}}
var processData=function(data){self.data=data;var shownLevel=null;self.o=$.extend(self.o,data);if(self.data.zoomlimit)self.o.maxscale=parseFloat(self.data.zoomlimit);self.o.landmark=self.el.data('landmark');if(self.o.landmark){self.o.sidebar=false;self.o.zoombuttons=false;self.o.deeplinking=false;}
self.container=$('<div></div>').addClass('mapplic-container').appendTo(self.el);self.map=$('<div></div>').addClass('mapplic-map').appendTo(self.container);if(self.o.zoom)self.map.addClass('mapplic-zoomable');self.levelselect=$('<select></select>').addClass('mapplic-levels-select');self.contentWidth=parseFloat(data.mapwidth);self.contentHeight=parseFloat(data.mapheight);if(self.o.minimap){self.minimap=new Minimap();self.minimap.init();}
if(self.o.sidebar){self.sidebar=new Sidebar();self.sidebar.init();self.sidebar.addCategories(data.categories);}
else self.container.css('width','100%');var nrlevels=0;if(data.levels){$.each(data.levels,function(index,level){var source=level.map,extension=source.substr((source.lastIndexOf('.')+1)).toLowerCase();var layer=$('<div></div>').addClass('mapplic-layer').attr('data-floor',level.id).hide().appendTo(self.map);switch(extension){case'jpg':case'jpeg':case'png':case'gif':$('<img>').attr('src',source).addClass('mapplic-map-image').appendTo(layer);break;case'svg':$('<div></div>').addClass('mapplic-map-image').load(source,function(){$(self.o.selector,this).each(function(){var location=self.getLocationData($(this).attr('id'));if(location){$(this).attr('class','mapplic-clickable');location.el=$(this);var fill=null;if(location.fill)fill=location.fill;else if(self.o.fillcolor)fill=self.o.fillcolor
if(fill){$(this).css('fill',fill);$('> *',this).css('fill',fill);}
if(self.o.landmark===location.id)$(this).attr('class','mapplic-active');}});$(self.o.selector,this).on('click touchend',function(){if(!self.dragging)self.showLocation($(this).attr('id'),600);});$('svg a',this).each(function(){var location=self.getLocationData($(this).attr('xlink:href').substr(1));if(location){$(this).attr('class','mapplic-clickable');location.el=$(this);}});$('svg a',this).click(function(e){var id=$(this).attr('xlink:href').substr(1);self.showLocation(id,600);e.preventDefault();});}).appendTo(layer);break;default:alert('File type '+extension+' is not supported!');}
if(self.minimap)self.minimap.addLayer(level);self.levelselect.prepend($('<option></option>').attr('value',level.id).text(level.title));if(!shownLevel||level.show)shownLevel=level.id;$.each(level.locations,function(index,location){if(location.lat&&location.lng){var pos=latlngToPos(location.lat,location.lng);location.x=pos.x;location.y=pos.y;}
var top=location.y*100,left=location.x*100;if(!location.pin)location.pin='default';if(location.pin.indexOf('hidden')==-1){if(self.o.markers){var pin=$('<a></a>').attr('href','#').addClass('mapplic-pin').css({'top':top+'%','left':left+'%'}).appendTo(layer);pin.on('click touchend',function(e){e.preventDefault();self.showLocation(location.id,600);});if(location.label)pin.html(location.label);if(location.fill)pin.css({'background-color':location.fill,'border-color':location.fill});pin.attr('data-location',location.id);pin.addClass(location.pin);location.el=pin;}}
if(self.sidebar)self.sidebar.addLocation(location);});nrlevels++;});}
if(self.o.alphabetic){$('.mapplic-list-container ol',self.el).each(function(){var mylist=$(this);var listitems=mylist.children('.mapplic-list-location').get();listitems.sort(function(a,b){var compA=$(a).text().toUpperCase();var compB=$(b).text().toUpperCase();return(compA<compB)?-1:(compA>compB)?1:0;})
$.each(listitems,function(idx,itm){mylist.append(itm);});});}
self.tooltip=new Tooltip().init();if(self.o.lightbox)self.lightbox=new Lightbox().init();if(self.o.hovertip)self.hovertip=new HoverTooltip().init();if(self.o.clearbutton)self.clearbutton=new ClearButton().init();if(self.o.zoombuttons)self.zoombuttons=new ZoomButtons().init();if(self.o.fullscreen)self.fullscreen=new Fullscreen().init();if(nrlevels>1){self.levels=$('<div></div>').addClass('mapplic-levels');var up=$('<a href="#"></a>').addClass('mapplic-levels-up').appendTo(self.levels);self.levelselect.appendTo(self.levels);var down=$('<a href="#"></a>').addClass('mapplic-levels-down').appendTo(self.levels);self.container.append(self.levels);self.levelselect.change(function(){var value=$(this).val();self.switchLevel(value);});up.click(function(e){e.preventDefault();if(!$(this).hasClass('mapplic-disabled'))self.switchLevel('+');});down.click(function(e){e.preventDefault();if(!$(this).hasClass('mapplic-disabled'))self.switchLevel('-');});}
self.switchLevel(shownLevel);$(window).resize(function(){if($(window).width()<668){if(self.el.hasClass('mapplic-fullscreen'))self.container.height($(window).height());else{var height=Math.min(Math.max(self.container.width()*self.contentHeight/self.contentWidth,$(window).height()*2/3),$(window).height()-66);self.container.height(height);}}
else self.container.height('100%');var wr=self.container.width()/self.contentWidth,hr=self.container.height()/self.contentHeight;if(self.o.mapfill){if(wr>hr)self.fitscale=wr;else self.fitscale=hr;}
else{if(wr<hr)self.fitscale=wr;else self.fitscale=hr;}
if(!self.data.zoomlimit)self.o.maxscale=self.fitscale;self.scale=normalizeScale(self.scale);self.x=normalizeX(self.x);self.y=normalizeY(self.y);zoomTo(self.x,self.y,self.scale,0);}).resize();if(self.o.landmark){self.showLocation(self.o.landmark,0);}
else{var init=self.getLocationData('init');if(init)self.moveTo(init.x,init.y,parseFloat(init.zoom),0);else self.moveTo(0.5,0.5,self.fitscale,0);}
if(self.o.deeplinking){if(history.pushState)self.deeplinking=new Deeplinking();else self.deeplinking=new DeeplinkingHash();self.deeplinking.init();}
self.el.trigger('mapready',self);if(self.o.zoom)addControls();}
var addControls=function(){var map=self.map,mapbody=$('.mapplic-map-image',self.map);document.ondragstart=function(){return false;}
mapbody.on('mousedown',function(e){self.dragging=false;map.data('mouseX',e.pageX);map.data('mouseY',e.pageY);if(map.is(':animated')){map.stop();self.x=normalizeX(map.offset().left-self.container.offset().left);self.y=normalizeY(map.offset().top-self.container.offset().top);self.scale=normalizeScale(map.width()/self.contentWidth);}
map.addClass('mapplic-dragging');self.map.on('mousemove',function(e){self.dragging=true;var x=e.pageX-map.data('mouseX')+self.x,y=e.pageY-map.data('mouseY')+self.y;x=normalizeX(x);y=normalizeY(y);zoomTo(x,y);map.data('lastX',x);map.data('lastY',y);});$(document).on('mouseup',function(){self.x=map.data('lastX');self.y=map.data('lastY');self.map.off('mousemove');$(document).off('mouseup');map.removeClass('mapplic-dragging');});});self.el.on('dblclick','.mapplic-map-image',function(e){e.preventDefault();var scale=self.scale;self.scale=normalizeScale(scale*2);self.x=normalizeX(self.x-(e.pageX-self.container.offset().left-self.x)*(self.scale/scale-1));self.y=normalizeY(self.y-(e.pageY-self.container.offset().top-self.y)*(self.scale/scale-1));zoomTo(self.x,self.y,self.scale,400,'easeInOutCubic');});if(self.o.mousewheel){$('.mapplic-layer',self.el).bind('mousewheel DOMMouseScroll',function(e,delta){var scale=self.scale;self.scale=normalizeScale(scale+scale*delta/5);e.preventDefault();self.x=normalizeX(self.x-(e.pageX-self.container.offset().left-self.x)*(self.scale/scale-1));self.y=normalizeY(self.y-(e.pageY-self.container.offset().top-self.y)*(self.scale/scale-1));zoomTo(self.x,self.y,self.scale,200,'easeOutCubic');});}
if(!('ontouchstart'in window||'onmsgesturechange'in window))return true;mapbody.on('touchstart',function(e){self.dragging=false;var orig=e.originalEvent,pos=map.position();map.data('touchY',orig.changedTouches[0].pageY-pos.top);map.data('touchX',orig.changedTouches[0].pageX-pos.left);mapbody.on('touchmove',function(e){e.preventDefault();self.dragging=true;var orig=e.originalEvent;var touches=orig.touches.length;if(touches==1){self.x=normalizeX(orig.changedTouches[0].pageX-map.data('touchX'));self.y=normalizeY(orig.changedTouches[0].pageY-map.data('touchY'));zoomTo(self.x,self.y,self.scale,50);}
else{mapbody.off('touchmove');}});mapbody.on('touchend',function(e){mapbody.off('touchmove touchend');});});var hammer=new Hammer(self.map[0],{transform_always_block:true,drag_block_horizontal:true,drag_block_vertical:true});hammer.get('pinch').set({enable:true});var scale=1,last_scale;hammer.on('pinchstart',function(e){self.dragging=false;scale=self.scale/self.fitscale;last_scale=scale;});hammer.on('pinch',function(e){self.dragging=true;if(e.scale!=1)scale=Math.max(1,Math.min(last_scale*e.scale,100));var oldscale=self.scale;self.scale=normalizeScale(scale*self.fitscale);self.x=normalizeX(self.x-(e.center.x-self.container.offset().left-self.x)*(self.scale/oldscale-1));self.y=normalizeY(self.y-(e.center.y-self.y)*(self.scale/oldscale-1));zoomTo(self.x,self.y,self.scale,100);});}
var latlngToPos=function(lat,lng){var deltaLng=self.data.rightLng-self.data.leftLng,bottomLatDegree=self.data.bottomLat*Math.PI/180,mapWidth=((self.data.mapwidth/deltaLng)*360)/(2*Math.PI),mapOffsetY=(mapWidth/2*Math.log((1+Math.sin(bottomLatDegree))/(1-Math.sin(bottomLatDegree))));lat=lat*Math.PI/180;return{x:((lng-self.data.leftLng)*(self.data.mapwidth/deltaLng))/self.data.mapwidth,y:(self.data.mapheight-((mapWidth/2*Math.log((1+Math.sin(lat))/(1-Math.sin(lat))))-mapOffsetY))/self.data.mapheight};}
var addClass=function(element,c){var classes=element.attr('class');if(classes.indexOf(c)==-1)element.attr('class',classes+' '+c);}
var removeClass=function(element,c){var classes=element.attr('class');if(classes)element.attr('class',classes.replace(c,'').trim());}
var hasClass=function(element,c){var classes=element.attr('class');return(classes.indexOf(c)>-1);}
var normalizeX=function(x){var minX=self.container.width()-self.contentWidth*self.scale;if(minX<0){if(x>0)x=0;else if(x<minX)x=minX;}
else x=minX/2;return x;}
var normalizeY=function(y){var minY=self.container.height()-self.contentHeight*self.scale;if(minY<0){if(y>=0)y=0;else if(y<minY)y=minY;}
else y=minY/2;return y;}
var normalizeScale=function(scale){if(scale<self.fitscale)scale=self.fitscale;else if(scale>self.o.maxscale)scale=self.o.maxscale;if(self.zoombuttons)self.zoombuttons.update(scale);return scale;}
var zoomTo=function(x,y,scale,d,easing){if(scale!==undefined){self.map.stop().animate({'left':x,'top':y,'width':self.contentWidth*scale,'height':self.contentHeight*scale},d,easing,function(){if(self.tooltip)self.tooltip.position();});}
else{self.map.css({'left':x,'top':y});}
if(self.tooltip)self.tooltip.position();if(self.minimap)self.minimap.update(x,y);self.el.trigger('positionchanged',location);}
self.switchLevel=function(target){switch(target){case'+':target=$('option:selected',self.levelselect).removeAttr('selected').prev().prop('selected','selected').val();break;case'-':target=$('option:selected',self.levelselect).removeAttr('selected').next().prop('selected','selected').val();break;default:$('option[value="'+target+'"]',self.levelselect).prop('selected','selected');}
if(!target)return;var layer=$('.mapplic-layer[data-floor="'+target+'"]',self.el);if(layer.is(':visible'))return;if(self.tooltip)self.tooltip.hide();$('.mapplic-layer:visible',self.map).hide();layer.show();if(self.minimap)self.minimap.show(target);var index=self.levelselect.get(0).selectedIndex,up=$('.mapplic-levels-up',self.el),down=$('.mapplic-levels-down',self.el);up.removeClass('mapplic-disabled');down.removeClass('mapplic-disabled');if(index==0)up.addClass('mapplic-disabled');else if(index==self.levelselect.get(0).length-1)down.addClass('mapplic-disabled');self.el.trigger('levelswitched',target);}
self.moveTo=function(x,y,s,duration,easing,ry){duration=typeof duration!=='undefined'?duration:400;ry=typeof ry!=='undefined'?ry:0.5;s=typeof s!=='undefined'?s:self.scale/self.fitscale;self.scale=normalizeScale(s);self.x=normalizeX(self.container.width()*0.5-self.scale*self.contentWidth*x);self.y=normalizeY(self.container.height()*ry-self.scale*self.contentHeight*y);zoomTo(self.x,self.y,self.scale,duration,easing);}
self.getLocationData=function(id){var data=null;$.each(self.data.levels,function(index,level){$.each(level.locations,function(index,location){if(location.id==id){data=location;}});});return data;}
self.showLocation=function(id,duration,check){$.each(self.data.levels,function(index,level){if(level.id==id){self.switchLevel(level.id);return false;}
$.each(level.locations,function(index,location){if(location.id==id){var action=(location.action&&location.action!='default')?location.action:self.o.action;switch(action){case'open-link':window.location.href=location.link;return false;case'open-link-new-tab':window.open(location.link);return false;case'select':if(location.el){if(hasClass(location.el,'mapplic-active'))removeClass(location.el,'mapplic-active');else addClass(location.el,'mapplic-active');}
return false;case'none':var zoom=location.zoom?parseFloat(location.zoom):self.o.maxscale;self.switchLevel(level.id);self.moveTo(location.x,location.y,zoom,600,'easeInOutCubic');break;case'lightbox':self.switchLevel(level.id);self.lightbox.show(location);break;default:self.switchLevel(level.id);self.tooltip.show(location);}
removeClass($('.mapplic-active',self.el),'mapplic-active');if(location.el)addClass(location.el,'mapplic-active');if((self.deeplinking)&&(!check))self.deeplinking.update(id);self.el.trigger('locationopened',location);}});});}
self.hideLocation=function(){removeClass($('.mapplic-active',self.el),'mapplic-active');if(self.deeplinking)self.deeplinking.clear();if(self.tooltip)self.tooltip.hide();self.el.trigger('locationclosed');}
self.updateLocation=function(id){var location=self.getLocationData(id);if((location.id==id)&&(location.el.is('a'))){if(location.lat&&location.lng){var pos=latlngToPos(location.lat,location.lng);location.x=pos.x;location.y=pos.y;}
var top=location.y*100,left=location.x*100;location.el.css({'top':top+'%','left':left+'%'});}}};$.extend($.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d);},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b;},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b;}});$.fn.mapplic=function(options){return this.each(function(){var element=$(this);if(element.data('mapplic'))return;var instance=(new Mapplic(element)).init(options);element.data('mapplic',instance);});};})(jQuery);jQuery(document).ready(function($){$('[id^=mapplic-id]').mapplic();});